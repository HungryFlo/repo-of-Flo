# 数学建模

## AI简史

### 传统神经网络

单输入神经元

多输入神经元

多个神经元组成的层

多层神经网络

**特点：**

传统神经网络的权重矩阵是固定的

$a = F(Wp + b)$ 

$a(t+1) = F(Wa(t) + b)$

### 深度学习

借鉴人脑的可塑性，权重可以更新，使用误差的反向传播算法来进行修正。

卷积神经网络 CNN ：提取特征

深度学习的发展脉络展示

## 数学建模示例

### 包饺子问题

面积与体积的倍数关系

### 估算悬崖高度

不断优化模型，考虑更多因素

对于难解的方程可通过估算其中的微小因素并进行不断迭代修正来实现

### 流言蜚语的传播

新增人数 = 未知人数 * 传播率

既要考虑传播率，也要考虑不传播率

### 装修铺瓷砖问题

黑白相间涂色

奇偶校验法

### 棋子问题

用二进制加法

用 ±1 的乘法：便于迭代，形成杨辉三角

### 椅子的稳定性（重要）

减少变量：从四条腿变成对角线上的两对腿

模型假设：规定“接触”的定义；规定地面为连续曲面；限制过于极端的情况；假设四角连线为正方形

“找到” $\rightarrow$ “存在” $\rightarrow$ 零点存在性定理/介值定理

使用正方形旋转对称性

**思考：** 长方形椅子怎么办？

### 双层玻璃的间距

关于假设的两点注意：

1. 假设是为了建立和求解问题方便。

2. 假设的数量要合理。

选择最终的结果

### 放射性废物的处理问题

问题的关键是考虑圆桶对力的承受能力（已知）和圆桶接触海底时的末速度，本质就是个运动学问题。
$$
\frac{dv}{dt} = \frac{dv}{dy} \frac{dy}{dt} = v \frac{dv}{dy}
$$
通过添加项来解决问题的思想。

### 动物体重的变化问题

**吸收与新陈代谢为常数的离散模型**

通过“翻译”，建立离散的差分方程模型：
$$
w(t+1) - w(t) = (2500 - 1200 - 16 * w(t)) / 10000 \\
w(t+1) - w(t) = 0.13 - 0.0016 * w(t) \\
$$
可以通过递推（等比数列求和等等）得出最后的极限。

**吸收与新陈代谢为常数的连续模型**
$$
x(t + \Delta t) - x(t) = \frac{2500 \Delta t - 1200 \Delta t - 16 x(t) \Delta t}{10000}
$$
两边取极限即可。

**改变每天吸收的热量**

自然状态下，体重越大吃得越多：
$$
x^{\prime}(t) = \frac{\frac{2500x(t)}{81.25}-1200-16x(t)}{10000}
$$
调节体重时：
$$
x^{\prime}(t) = \frac{2500（2 - \frac{x(t)}{81.25}）-1200-16x(t)}{10000}
$$
相对立的因素可以通过乘法合二为一：
$$
x^{\prime}(t) = \frac{\frac{2500x(t)}{81.25}（2-\frac{x(t)}{81.25})-1200-16x(t)}{10000}
$$

### 体重控制计划

#### 量纲法判断正误

得到一个经验公式或者得出一个自己的模型时，可以用量纲法来初步判断正误。

#### 参数敏感度分析

某一个参数增加百分之几，最终结果相应会增加百分之几。

交叉验证、网格搜索

在深度学习超参数的确定时，如果对某个超参数敏感度比较高，就要更加细密地取值。

## 图与网络

超图学习

### 七桥问题

图论的起点

偶数条边

### 相识问题

6个人的聚会中，一定可以找出3个人，彼此均认识或均不认识

一个六阶图中一定有一个实线三角形或一个虚线三角形

试探的方法，其实本来是想穷举的，但是奈何情况数太多，实在穷举不完，所以只能怀着对抗结论成立的方向不断向下试探，排除大量的情况，从而最后不得不“成立”

### 最短路径问题

凸集与分离定理

凸集在凸优化中还会有很好地使用

要证明最短路径，最粗暴的方法是进行穷举，对于无限的集合进行穷举，最重要的是分类，这里的分类方法是：路径内侧（靠圆心的那一侧）和路径外侧，使用分离定理，就可以使用“两点之间，线段最短”的理论来进行证明。

## 代数模型

### 图像重建问题

约束与变量的数量的关系的研究

当两个方向的约束不足时，可以增加其他角度的约束。

使用线性代数的方式解决。

### 植物基因的分布

问题重现

设一农业研究所植物园中某种植物的基因型为AA、 Aa和aa。 研究所计划采用AA型的植物与每一种基因型植物相结合的方案培育植物后代。 问经过若干年后， 这种植物的任意一代的三种基因型分布如何?  

符号说明

x1(n)**—**第n代中基因型AA的植物占植物总数的百分比

x2(n)**—**第n代中基因型Aa的植物占植物总数的百分比

x3(n)**—**第n代中基因型aa的植物占植物总数的百分比  



按列建立表格，表示基因向下传递的结果；按行读取表格，表示基因的来源，获得递推关系式。

用矩阵对递推关系进行表示和解耦，然后通过矩阵的乘法（乘幂）来建立第n项与首项的关系。

计算矩阵的乘幂可以使用归纳法或者矩阵分解的方法来进行。

求极限得到最终的结果。

### 希尔密码

问题背景：

移位密码明文字符和密文字符有相同的使用频率，破译者可从统计出来的字符频率中找到规律，进而找出破译的突破口。 要克服这一缺陷就必须**改变字符间的一一对应**。

改进方法：

加密：

将明文分成 **n**个一组， 用对应的数字代替，就变成了一个**n**维向量。 如果取定一个**n**阶的非奇异矩阵**A**（ 此矩阵为主要密钥），用**A**去乘每一向量，即可起到加密的效果。

解密：

将密文也分成**n**个一组，同样变换成**n**维向量，只需用**A**逆去乘这些向量，即可将他们变回原先的明文。

问题一：

如何保证变换或逆变换后的结果是0～ 25之间的整数。

解决方法：

只要密钥矩阵A或其逆矩阵A-1是非负整数矩阵即可保证结果是整数向量。

对该向量的每个元素以26为模求同余运算即可使结果在0～25之间。

问题二：

如何保证解密矩阵A-1是0～25之间的整数矩阵。 

这就要对密钥矩阵的行列式det(A)增加一些限制。  

解决方法：

从普通的逆元的定义拓展到同余意义上的逆元，以保证加密矩阵和解密矩阵操作后的结果为规定范围内的整数。

由 线性代数可知* 1 , d e t( ) *A A A*  0, 0, (mod 26) 1,(mod 26)*a b abb*  -1若 满足 则称b为a在同余意义上的逆元， 记作a其中A*是A的伴随矩阵，从而A-1的元素中就有可能出现分数。 克服这一困难的途径仍然是引入同余运算， 即在同余意义上引入除法。

### 森林管理问题

#### 题目回顾与分析

> 森林中的树木每年都要有一批被砍伐出售.为了使这片森林不被耗尽且每年都有所收获,每当砍伐一棵树时,应该就地补种一棵幼苗,使森林树木的总数保持不变.被出售的树木,其价值取决于树木的高度.开始时森林中的树木有着不同的高度.我们希望能找到一个方案,在维持收获的前提下,如何砍伐树木,才能使被砍伐的树木获得最大的经济价值?

读题的方法：

先看需求，确定问题的类型。

“最大的经济价值”：优化问题

“其价值取决于树木的高度”：使用区间来分割不同的价值和对应的高度

#### 假设与符号说明

首先需要对树的价值分类：分类要先定上下界，不要分地没完没了。

> 把森林中的树木按照高度分为n类:第k类:(1≤ k＜n)高度为[$h_{k-1}$,$h_k$］ ,每棵的经济价值为 $p_k$
>
> 其中，
>
> 第1类: 幼苗,高度为[０ ,$h_1$］ , p1=0,
>
> 第n类: 高度为[$h_{n-1}$ ,∞)

先从简单的模型开始研究，然后不断做出更符合实际情况的假设。

> 1. 每年对森林中树木砍伐一次, 留下的树木和补种的幼苗,经过一年的生长期后, 与上一次砍伐前的高度状态相同（ 根据保持持续收获的要求）
> 2. 在一年的生长期内树木最多只能生长一个高度级,即第k类的树木可能进入k+1类,也可能停留在k类中
> 3. 树木没有死亡

既有明显的假设，也有隐藏的假设。（如变量设为常量，代表不随时间变化）

> 记
>
> $x_{k(t)}$ ,k=1,2,…,n 是第t年第k类树木的数量.
>
> $y_k$ , k=1,2,…,n 是第k类树木被砍伐的数量

#### 模型建立

设 $g_k$ 是经过一年从第$k$类中长高到第$k+1$类中的树木比例,$ 0< g_k <1$

则 $1-g_k$ 是经过一年仍然留在第$k$类中的树木比例。



设森林中树木的总数是$s$,即
$$
x_1(t) + x_2(t) + ... + x_n(t) = s
$$
其中s是根据土地数量预先确定的数值.



由前面的分析,引入下面四个量：

$\vec{x}(t)$ 数量向量

$\vec{y}$ 收获向量（如果拓宽假设，使得收获向量随时间进行改变，则变为一个与时间有关的函数）

$R$ 种植矩阵

$G$ 生长矩阵（如果拓宽假设，使得有些树木可以越级超快生长，那么将变成一个更加“饱满”的下三角矩阵。）

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240313202714787.png" alt="image-20240313202714787" style="zoom: 50%;" />

树木生长方程：
$$
\vec{x}(t+1) = G\vec{x}(t), 其中 t = 1, 2, ...
$$
平衡关系（可行域）：

（如果拓宽假设，考虑死亡率，则需要在下面的等式左边减死亡项）
$$
GX(t) - y + R y = X(t), 其中t = 1, 2,...
$$
<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240313203506027.png" alt="image-20240313203506027" style="zoom:50%;" />

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240313203525077.png" alt="image-20240313203525077" style="zoom:50%;" />

目前并不能直接得到 $y_i$ 的约束。

所以只好把目标函数改掉，改成关于 $x$ 的函数。

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240313203615148.png" alt="image-20240313203615148" style="zoom:50%;" />

优化模型变化为如下形式：

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240313203701543.png" alt="image-20240313203701543" style="zoom:50%;" />

#### 模型的求解



## 线性代数的应用与启示

### 线性代数中的运算

外积

### 前景和背景的分离

背景在前后帧之间变化不大，因此矩阵是低秩的。

在计算秩的时候计算机并不太擅长，因此

### 推荐系统

分析相似性也可以使用秩进行刻画。

### 谱聚类

#### 概述

矩阵的谱可以理解为矩阵在不同基底上的特征值。（使用特征值分解）

谱聚类的**基本出发点**：

1. 用数据点构造一张“无向加权图”
2. 将这张图分割成若干个子图，组内尽可能相似，组间尽可能不同

谱聚类的**基本步骤**：

1. **构建相似矩阵**：根据数据点之间的距离度量，构建相似矩阵。常用的方法包括ϵ-邻近法、K邻近法和全连接法。
2. **计算拉普拉斯矩阵**：拉普拉斯矩阵是由度矩阵和邻接矩阵构成的。它具有一些重要的性质，如对称性和特征值的关联。
3. **降维**：通过拉普拉斯矩阵的特征值分解，得到对应的特征向量，从而实现维度规约。
4. **切图聚类**：根据特征向量进行切图，将图切分成多个子图，每个子图对应一个簇。

#### 关于拉普拉斯矩阵

**图的表示**：

1. **邻接矩阵**：邻接矩阵是一种表示图的方式。它是一个方阵，其中的元素表示节点之间是否相邻。如果两个节点相邻，那么对应的矩阵元素为1，否则为0。
2. **加权度矩阵**：加权度矩阵是一个对角矩阵，其中的对角元素表示每个节点的度（即与之相邻的边的数量）。
3. **拉普拉斯矩阵**：拉普拉斯矩阵是**加权度矩阵**与**邻接矩阵**之差。它有一些重要的性质，可以帮助我们研究图的特性。
   - 拉普拉斯矩阵是对称矩阵。
   - 它的最小特征值为0，对应的特征向量是常向量。
   - 拉普拉斯矩阵的谱（特征值的集合）与图的联通分量有关。

拉普拉斯矩阵在图论、机器学习和深度学习中都有重要的应用。

**加权度矩阵**：

- 加权度矩阵是一个对角矩阵，其中的对角元素表示每个节点的度（即与之相邻的边的数量）。
- 如果两个节点之间没有边连接，则在加权度矩阵中对应的元素为0。

**举个例子**：

- 假设我们有一个加权图，其中每个节点表示一个城市，边的权重表示城市之间的距离。
- 我们可以构建加权度矩阵，其中对角元素表示每个城市的度（即与之相邻的城市的数量）。
- 然后，我们可以计算拉普拉斯矩阵，将加权度矩阵减去邻接矩阵。

让我们来看一个简单的例子：

假设我们有以下加权度矩阵：
$$
D = \begin{bmatrix} 3 & 0 & 0 \\ 0 & 4 & 0 \\ 0 & 0 & 2 \end{bmatrix}
$$
现在，我们有以下邻接矩阵：
$$
A = \begin{bmatrix} 0 & 1 & 0 \\ 1 & 0 & 1 \\ 0 & 1 & 0 \end{bmatrix}
$$
我们可以计算拉普拉斯矩阵：
$$
L = D - A = \begin{bmatrix} 3 & 0 & 0 \\ 0 & 4 & 0 \\ 0 & 0 & 2 \end{bmatrix} - \begin{bmatrix} 0 & 1 & 0 \\ 1 & 0 & 1 \\ 0 & 1 & 0 \end{bmatrix} = \begin{bmatrix} 3 & -1 & 0 \\ -1 & 4 & -1 \\ 0 & -1 & 2 \end{bmatrix}
$$

#### 如何求“最小割”？

**转化目标函数：**
$$
\min \limits_{A_1, ...,A_k} \sum\limits_{l=1}^{k} \sum\limits_{i \in A_l,j \notin A_l} w_{i,j}  \text{转化为} \min\limits_{Q} Tr(Q^{T}LQ), s.t. q_{i,l}\in \{1,-1\}
$$
证明之后补。

$q_{i,l}\in \{1,-1\}$ 整数约束会导致求解不便，对其视为实数，但要求 $q_l^Tq_l = n$

进一步把最小化式子中的常数 $n$ 隐去，就可以最终转化为**计算拉普拉斯矩阵的最小前k个特征值及其对应的特征向量**。

## 微分方程模型

### 导语

对于动态问题，通常可以与变化率、进而与微分方程联系起来。即：可以考虑建立微分方程模型。

微分方程模型建立的步骤：

1. 翻译或转化：将实际问题中的条件转换为表示导数的用词。
2. 建立瞬时表达式
3. 统一物理单位
4. 确定初始条件或边界信息

在建立方程的过程中，既可以使用已知的定律列方程，又可以通过数据提出假设，再根据假设列出方程。

### 水的流出问题

#### 题目原文

一横截面积为 A，高为 H 的水池内盛满了水，有池底一横截面积为 B 的小孔放水。设水从小孔流出的速度为v，求在任意时刻的水面高度和将水放空所需的时间。

#### 问题分析

从水面1到水面2所失去的水量等于从小孔流出的水量。

#### 建模与求解

1. 从水面1到水面2所失去的体积为 Ah

   --- 在时间内 t，实际损失的体积是 Ah 

2. 在同样时间内，水从小孔流出的体积为 B S 

   --- 是水在 时间内从小孔流出保持水平前进时所经过的距离

#### TODO

### 新产品的销售量

#### 题目原文

一种耐用新产品进入市场后,一般会经过一销售量先不断增加,然后下降的过程(产品的生命周期-PLC).有一种PLC曲线为钟型, 试建立模型分析此现象。

#### 问题分析

当一个新产品进入市场时，有关产品信息的传播途径如何？

信息传播的途径:

1. 厂家提供的广告 ---消费者以外的信息

2. 一部分人购买后对产品的评价使周围人得到的信息---消费者内部的信息

耐用产品的累积销售量可认为是购买者人数

#### 建模与求解

K --- 潜在的消费者总数

n(t) --- t 时刻购买了该产品的人数

则在 $ [ t, t + \Delta t]$ 中, 购买者增量
$$
\Delta n = 
\begin{cases}
\Delta n_1 &\text{来自消费者外部的产品信息导致的购买者增量}\\
\Delta n_2 &\text{来自消费者内部的产品信息导致的购买者增量}
\end{cases}
$$

$$
\Delta n_1 = a(K-n(t))\Delta t 
$$

$$
\Delta n_2 = bn(t)(K-n(t))\Delta t
$$



# 自学

## 全球定位

### 问题提出

如何计算经纬度

经度：转化为确定时间的问题

### 模型的构建与求解



### 模型的分析

误差的影响：

来源 

时间误差：卫星时钟、空间误差：轨道误差、电离层延迟、对流层延迟、接收机噪声

敏感性分析（如求导）可以算出误差的范围

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240305212518619.png" alt="image-20240305212518619" style="zoom:50%;" />

简化：假设没有各种误差

抽象：写成方程

计算：求解方程

### 问题的解决

基本模型：科学原理可行，但达不到工程应用的要求

科学 技术 工程

# 作业

## 第一次作业：C题

$$
x
$$

# 小组作业

## 读题

题目中没有一个字是浪费的，都是经过精练的。