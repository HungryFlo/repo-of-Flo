

# 数学建模

[TOC]



## AI简史

### 传统神经网络

单输入神经元

多输入神经元

多个神经元组成的层

多层神经网络

**特点：**

传统神经网络的权重矩阵是固定的

$a = F(Wp + b)$ 

$a(t+1) = F(Wa(t) + b)$

### 深度学习

借鉴人脑的可塑性，权重可以更新，使用误差的反向传播算法来进行修正。

卷积神经网络 CNN ：提取特征

深度学习的发展脉络展示

## 数学建模示例

### 包饺子问题

#### 知识点

探究几何体面积与体积的倍数关系。

#### 问题背景

+ 通常，一公斤面，一公斤馅料，包100个饺子
+ 今天，一公斤面不变，馅比一公斤多了0.4公斤，问：是否可以多包几个（小一点），或少包几个（大一些），将这些馅仍用1公斤面包完？
+ 多包：皮少一些；少包：皮大一些

#### 问题建模求解

+ 面积为S的一个皮，宝成体积为V的饺子。若分成n个皮，每个圆的面积为s，包成体积为v

![image-20240307190949986](C:\Users\zxm\AppData\Roaming\Typora\typora-user-images\image-20240307190949986.png)

#### 假设

1. 皮的厚度一样
2. 饺子的形状一样

#### 模型

+ R~大皮的半径

+ r~小皮的半径

  我们可得如下表达式：

$$
S=k_{1}R^2,V=k_{2}R^3  \Rightarrow  V=KS^{3/2}
$$

$$
s=k_{1}r^2,v=k_{2}r^3\Rightarrow s=ks^{3/2}
$$

由于S=ns，因此我们得以得到：
$$
V=n^{3/2}v
$$

#### 应用

$$
V=\sqrt{n}(nv)\geq nv
$$

$$
V是nv的\sqrt{n}倍
$$

若100个饺子包1公斤馅，则50个饺子可以包1.4公斤馅

### 估算悬崖高度

#### 知识点

不断优化模型，考虑更多因素

对于难解的方程可通过估算其中的微小因素并进行不断迭代修正来实现

#### 题目概述

假如你站在崖顶且身上带着一只具有跑表功能的计算器，你也许会出于好奇心想扔下一块石头听回声的方法来估计山崖的高度，假定你能准确地测定时间，你又怎样来推算山崖的高度呢？

#### 简单想法

记崖高为h

假定空气阻力不计，可以利用自由落体运动的公式来计算。
$$
h=\frac{1}{2}gt^2
$$
例如，设测得时间啊为`t=4`秒，`g=9.81米/秒^2`，则可求得
$$
h\approx78.5(米)
$$

#### 进一步考虑

除去地球吸引力外，对石块下落影响最大的当属空气阻力。根据力学知识，此时可设空气阻力正比于石块下落的速度，阻力系数r为常数。由**牛顿第二定律**可得：
$$
m\frac{d^2h}{dt^2}=mg-r\frac{dh}{dt}
$$

$$
h(0)=0,\frac{dh}{dt}|_{t=0}=0
$$

令k=r/m，解得：
$$
h(t)=\frac{g}{k}t+\frac{g}{k^2}e^{-kt}-\frac{g}{k^2}
$$
若设k=0.05，并仍设t=4秒，则可求得h≈73.6米

#### 深入考虑

听到回声再跑表，计算得到的时间中包含了反应时间，不妨设平均反应时间为0.1秒，扣除反应时间后应为3.9秒，带入得到h≈69.9米

#### 进一步深入考虑

声音的传回需要时间，为此，令石块下落的真正时间为$t_{1}$，声音传回来的时间即为$t_{2}$，得到一个方程组：

$$
h=\frac{g}{k}(t_{1}+\frac{1}{k}e^{-kt_{1}})-\frac{g}{k^2}
$$

$$
h=340t_{2}
$$

$$
t_{1}+t_{2}=3.9
$$

但是，**求解这个方程组是个麻烦的问题**，因此我们可以换个思路，<u>$t_{2}$这个值是非常小的</u>

相对于石块的速度，声音的速度快的多，我们可以前一方法先求依次$h$，再用声速公式得到$t_{2}=\frac{h}{340}$，和$t=t_{1}+t_{2}$校正$t$​

仍设扣除反应时间后$t=3.9秒$，带入得到$h\approx69.9(米)$，则回声传回时间为$t_{2}=\frac{h}{340}\approx0.21(秒)$，

故：$t_{1}=t-t_{2}\approx3.69(秒)$​。

求得$h\approx62.3(米)$

### 流言蜚语的传播

#### 知识点

新增人数 = 未知人数 * 传播率

既要考虑传播率，也要考虑不传播率

#### 题目概述

假设在某地区的总人口数为$N$，在短期内不变，$x(t)$表示知道消息的人数所占的百分比，初始时刻的百分比$x_{0}\leq1$，传播率为$h$。

#### 建立数学模型与求解

$$
\frac{dx}{dt}N=hN(1-x)
$$

$$
x(0)=x_{0}
$$

新增的人数等与剩下不知道的人数乘以传播率，求解可以得到：
$$
x(t)=(x_{0}-1)e^{-ht}+1
$$
​                                                                且${\displaystyle\lim_{x \to +\infty }} x(t)=1$​

显然，我们忽略了不传播率$r$，那么数学模型可以修正为：
$$
\frac{dx}{dt}N=N[h-(h+r)x]
$$

$$
x(0)=x_{0}
$$

求解得到：
$$
x(t)=(x_{0}-\frac{h}{h+r})e^{-(h+r)t} +\frac{h}{h+r}
$$
于是有：
$$
{\displaystyle\lim_{t \to +\infty }} x(t)=\frac{h}{h+r}\leq1
$$
这样的结论表明：随着时间的增长，消息会慢慢的淡化，这是符合实际情况的。

### 装修铺瓷砖问题

黑白相间涂色

奇偶校验法

### 棋子问题

用二进制加法

用 ±1 的乘法：便于迭代，形成杨辉三角

### 椅子的稳定性（重要）

减少变量：从四条腿变成对角线上的两对腿

模型假设：规定“接触”的定义；规定地面为连续曲面；限制过于极端的情况；假设四角连线为正方形

“找到” $\rightarrow$ “存在” $\rightarrow$ 零点存在性定理/介值定理

使用正方形旋转对称性

**思考：** 长方形椅子怎么办？

### 双层玻璃的间距

关于假设的两点注意：

1. 假设是为了建立和求解问题方便。

2. 假设的数量要合理。

选择最终的结果

### 放射性废物的处理问题

问题的关键是考虑圆桶对力的承受能力（已知）和圆桶接触海底时的末速度，本质就是个运动学问题。
$$
\frac{dv}{dt} = \frac{dv}{dy} \frac{dy}{dt} = v \frac{dv}{dy}
$$
通过添加项来解决问题的思想。

### 动物体重的变化问题

#### 题目原文

某动物从食物中每天获得2500卡的热量，其中1200卡用于基本的新陈代谢，每天每公斤体重需要再消耗16卡。假如它每增加一公斤体重需要10000卡的热量。问该动物的体重怎样变化？

**吸收与新陈代谢为常数的离散模型**

通过“翻译”，建立离散的差分方程模型：
$$
w(t+1) - w(t) = (2500 - 1200 - 16 * w(t)) / 10000 \\
w(t+1) - w(t) = 0.13 - 0.0016 * w(t) \\
$$
可以通过递推（等比数列求和等等）得出最后的极限。

**吸收与新陈代谢为常数的连续模型**
$$
x(t + \Delta t) - x(t) = \frac{2500 \Delta t - 1200 \Delta t - 16 x(t) \Delta t}{10000}
$$
两边取极限即可。

**改变每天吸收的热量**

自然状态下，体重越大吃得越多：
$$
x^{\prime}(t) = \frac{\frac{2500x(t)}{81.25}-1200-16x(t)}{10000}
$$
调节体重时：
$$
x^{\prime}(t) = \frac{2500（2 - \frac{x(t)}{81.25}）-1200-16x(t)}{10000}
$$
相对立的因素可以通过乘法合二为一：
$$
x^{\prime}(t) = \frac{\frac{2500x(t)}{81.25}（2-\frac{x(t)}{81.25})-1200-16x(t)}{10000}
$$

 #### 问题的推广

+ 每天得到的热量和基本的新陈代谢热量依赖于体重的变化
+ 每天每公斤的体重需要消耗
+ 每天单位体重消耗的热量与年龄有关

### 体重控制计划

#### 量纲法判断正误

得到一个经验公式或者得出一个自己的模型时，可以用量纲法来初步判断正误。

#### 参数敏感度分析

某一个参数增加百分之几，最终结果相应会增加百分之几。

交叉验证、网格搜索

在深度学习超参数的确定时，如果对某个超参数敏感度比较高，就要更加细密地取值。

## 图与网络

超图学习

### 七桥问题

图论的起点

偶数条边

### 相识问题

6个人的聚会中，一定可以找出3个人，彼此均认识或均不认识

一个六阶图中一定有一个实线三角形或一个虚线三角形

试探的方法，其实本来是想穷举的，但是奈何情况数太多，实在穷举不完，所以只能怀着对抗结论成立的方向不断向下试探，排除大量的情况，从而最后不得不“成立”

### 最短路径问题

凸集与分离定理

凸集在凸优化中还会有很好地使用

要证明最短路径，最粗暴的方法是进行穷举，对于无限的集合进行穷举，最重要的是分类，这里的分类方法是：路径内侧（靠圆心的那一侧）和路径外侧，使用分离定理，就可以使用“两点之间，线段最短”的理论来进行证明。

## 代数模型

### 图像重建问题

约束与变量的数量的关系的研究

当两个方向的约束不足时，可以增加其他角度的约束。

使用线性代数的方式解决。

把原物体抽象成矩阵，矩阵每一行（列）的求和过程：**图像的射线和（线积分）及投影数据**。

<center><font color="red">“多角度采集数据+矩阵求和+数学处理手段” </font></center>

- 探测器：以四个探测元为例
- 矩阵：连续图像，每个矩阵元素代表一个均匀像素
- $x_i(i=1,2,3,4)$：第$i$个像素的线密度数值
- 矩阵投影数据：图像线积分数值$p(s,\theta)$
- 线积分在每个像素内的线段长度$a_{ij}$（$i$是探测元编号，$j$是像素编号）
  $$p(i,\theta)=a_{i1}x_1+a_{i2}x_2+a_{i3}x_3+a_{i4}x_4$$

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\0.4.1.jpg" alt="0.4.1" style="zoom:50%;" />

  当两个方向的约束不足时，可以增加其他角度的约束，列线性方程组求解。

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\0.4.2.jpg" alt="0.4.2" style="zoom:50%;" />

### 植物基因的分布

问题重现

设一农业研究所植物园中某种植物的基因型为AA、 Aa和aa。 研究所计划采用AA型的植物与每一种基因型植物相结合的方案培育植物后代。 问经过若干年后， 这种植物的任意一代的三种基因型分布如何?  

##### 符号说明

- $x_1(n)$—第$n$代中基因型$AA$的植物占植物总数的百分比

- $x_2(n)$—第$n$代中基因型$Aa$的植物占植物总数的百分比

- $x_3(n)$—第$n$代中基因型$aa$的植物占植物总数的百分比  
  
- 显然，$x_1(n)+x_2(n)+x_3(n)=1$
  
  <img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\0.4.3.jpg" alt="0.4.3" style="zoom:50%;" />
  得到迭代的基因型分布关系：
  $$x_1(n)=x_1(n-1)+\frac{1}{2}x_2(n-1)$$  
  $$x_2(n)=\frac{1}{2}x_2(n-1)+x_3(n-1)$$
  $$x_3(n)=0$$
  用向量形式表示：
  $$\vec x(n)=L\vec x(n-1),n=1,2,3,...$$
  $$\vec x(n)=L^n\vec x(0),n=1,2,3,...$$
  用对角化方法求$L^n$，即求出可逆矩阵$P$和对角矩阵$D$，使得$L=PDP^{-1}$，从而：
  $$L^n=PD^nP^{-1}$$
  利用特征值和特征向量的方式求解$L^n$，代入即可得到$x_1(n)$，$x_2(n)$，$x_3(n)$的关系式。取$x\to\infty$，即可得出$x_1(n)\to1$，$x_2(n)\to0$，$x_3(n)\to0$。
  结论：培育得到的$AA$型植物所占比例不断增加，在极限状态下所有植物的基因型都会为$AA$型。



按列建立表格，表示基因向下传递的结果；按行读取表格，表示基因的来源，获得递推关系式。

用矩阵对递推关系进行表示和解耦，然后通过矩阵的乘法（乘幂）来建立第n项与首项的关系。

计算矩阵的乘幂可以使用归纳法或者矩阵分解的方法来进行。

求极限得到最终的结果。

### 希尔密码

##### 问题背景（移位密码）

移位密码明文字符和密文字符有相同的使用频率，破译者可从统计出来的字符频率中找到规律，进而找出破译的突破口。 要克服这一缺陷就必须**改变字符间的一一对应**。

##### 希尔密码的加密与解密

- **加密**：

1.  将明文分成$n$个一组， 用对应的数字代替，就变成了一个$n$维向量；
2.  取定一个$n$阶的非奇异矩阵$A$（即密钥矩阵），用$A$去乘（左乘或右乘）每一向量；
3.  将新向量的每一个分量关于模$m$取余运算；
4.  将新向量的每一个数字按照原规律对应回相应字符，即可加密。

- **解密**：

1. 将密文先用数字表示，并分成$n$个一组，变换成$n$维向量；
2. 只需用密钥矩阵的逆矩阵$A^{-1}$乘（左乘或右乘）这些向量；
3. 将所得向量的每一个分量关于模$m$（通常为26）取余运算；
4. 将所得向量的每一个数字按照规律对应回相应字符，即可解密。

- **求解逆矩阵$A^{-1}$**：

1. 求出行列式$|A|$，并对其进行取模运算；
2. 求出$|A|^{-1}$，<font color="red"> 注意在模运算中逆元的求解为相乘模26余1 </font>;
3. 求出$A^*$，$A^{-1}=|A|^{-1}*A^*$，再对矩阵的每一个元素进行模运算。

>注意：
>
>1.  从普通的逆元的定义拓展到同余意义上的逆元，以保证加密矩阵和解密矩阵操作后的结果为规定范围内的整数。
>2.  希尔密码是以矩阵法为基础的，明文与密文的对应由$n$阶矩阵$A$确定。矩阵$A$的阶数是事先约定的，与明文分组时每组字母的字母数量相同。如果明文所含字数与$n$不匹配，则最后几个分量可任意补足。

### 森林管理问题

用相应的向量、矩阵、线性方程等代数模型和手段来刻画分析实际问题。

#### 题目回顾与分析

> 森林中的树木每年都要有一批被砍伐出售.为了使这片森林不被耗尽且每年都有所收获,每当砍伐一棵树时,应该就地补种一棵幼苗,使森林树木的总数保持不变.被出售的树木,其价值取决于树木的高度.开始时森林中的树木有着不同的高度.我们希望能找到一个方案,在维持收获的前提下,如何砍伐树木,才能使被砍伐的树木获得最大的经济价值?

读题的方法：

先看需求，确定问题的类型。

“最大的经济价值”：优化问题

“其价值取决于树木的高度”：使用区间来分割不同的价值和对应的高度

#### 假设与符号说明

首先需要对树的价值分类：分类要先定上下界，不要分地没完没了。

> 把森林中的树木按照高度分为n类:第k类:(1≤ k＜n)高度为[$h_{k-1}$,$h_k$］ ,每棵的经济价值为 $p_k$
>
> 其中，
>
> 第1类: 幼苗,高度为[０ ,$h_1$］ , p1=0,
>
> 第n类: 高度为[$h_{n-1}$ ,∞)

先从简单的模型开始研究，然后不断做出更符合实际情况的假设。

> 1. 每年对森林中树木砍伐一次, 留下的树木和补种的幼苗,经过一年的生长期后, 与上一次砍伐前的高度状态相同（ 根据保持持续收获的要求）
> 2. 在一年的生长期内树木最多只能生长一个高度级,即第k类的树木可能进入k+1类,也可能停留在k类中
> 3. 树木没有死亡

既有明显的假设，也有隐藏的假设。（如变量设为常量，代表不随时间变化）

> 记
>
> $x_{k(t)}$ ,k=1,2,…,n 是第t年第k类树木的数量.
>
> $y_k$ , k=1,2,…,n 是第k类树木被砍伐的数量

#### 模型建立

设 $g_k$ 是经过一年从第$k$类中长高到第$k+1$类中的树木比例,$ 0< g_k <1$

则 $1-g_k$ 是经过一年仍然留在第$k$类中的树木比例。



设森林中树木的总数是$s$,即
$$
x_1(t) + x_2(t) + ... + x_n(t) = s
$$
其中s是根据土地数量预先确定的数值.



由前面的分析,引入下面四个量：

$\vec{x}(t)$ 数量向量

$\vec{y}$ 收获向量（如果拓宽假设，使得收获向量随时间进行改变，则变为一个与时间有关的函数）

$R$ 种植矩阵

$G$ 生长矩阵（如果拓宽假设，使得有些树木可以越级超快生长，那么将变成一个更加“饱满”的下三角矩阵。）

<img src="数学建模.assets\image-20240313202714787.png" alt="image-20240313202714787" style="zoom: 50%;" />

树木生长方程：
$$
\vec{x}(t+1) = G\vec{x}(t), 其中 t = 1, 2, ...
$$
平衡关系（可行域）：

（如果拓宽假设，考虑死亡率，则需要在下面的等式左边减死亡项）
$$
GX(t) - y + R y = X(t), 其中t = 1, 2,...
$$
<img src="数学建模.assets\image-20240313203506027.png" alt="image-20240313203506027" style="zoom:50%;" />

<img src="数学建模.assets\image-20240313203525077.png" alt="image-20240313203525077" style="zoom:50%;" />

目前并不能直接得到 $y_i$ 的约束。

所以只好把目标函数改掉，改成关于 $x$ 的函数。

<img src="数学建模.assets\image-20240313203615148.png" alt="image-20240313203615148" style="zoom:50%;" />

优化模型变化为如下形式：

<img src="数学建模.assets\image-20240313203701543.png" alt="image-20240313203701543" style="zoom:50%;" />

#### 模型的求解



## 线性代数的应用与启示

### 线性代数中的运算

外积

### 前景和背景的分离

背景在前后帧之间变化不大，因此矩阵是低秩的。

在计算秩的时候计算机并不太擅长，因此

### 推荐系统

分析相似性也可以使用秩进行刻画。

### 谱聚类

#### 概述

矩阵的谱可以理解为矩阵在不同基底上的特征值。（使用特征值分解）

谱聚类的**基本出发点**：

1. 用数据点构造一张“无向加权图”
2. 将这张图分割成若干个子图，组内尽可能相似，组间尽可能不同

谱聚类的**基本步骤**：

1. **构建相似矩阵**：根据数据点之间的距离度量，构建相似矩阵。常用的方法包括ϵ-邻近法、K邻近法和全连接法。
2. **计算拉普拉斯矩阵**：拉普拉斯矩阵是由度矩阵和邻接矩阵构成的。它具有一些重要的性质，如对称性和特征值的关联。
3. **降维**：通过拉普拉斯矩阵的特征值分解，得到对应的特征向量，从而实现维度规约。
4. **切图聚类**：根据特征向量进行切图，将图切分成多个子图，每个子图对应一个簇。

#### 关于拉普拉斯矩阵

**图的表示**：

1. **邻接矩阵**：邻接矩阵是一种表示图的方式。它是一个方阵，其中的元素表示节点之间是否相邻。如果两个节点相邻，那么对应的矩阵元素为1，否则为0。
2. **加权度矩阵**：加权度矩阵是一个对角矩阵，其中的对角元素表示每个节点的度（即与之相邻的边的数量）。
3. **拉普拉斯矩阵**：拉普拉斯矩阵是**加权度矩阵**与**邻接矩阵**之差。它有一些重要的性质，可以帮助我们研究图的特性。
   - 拉普拉斯矩阵是对称矩阵。
   - 它的最小特征值为0，对应的特征向量是常向量。
   - 拉普拉斯矩阵的谱（特征值的集合）与图的联通分量有关。

拉普拉斯矩阵在图论、机器学习和深度学习中都有重要的应用。

**加权度矩阵**：

- 加权度矩阵是一个对角矩阵，其中的对角元素表示每个节点的度（即与之相邻的边的数量）。
- 如果两个节点之间没有边连接，则在加权度矩阵中对应的元素为0。

**举个例子**：

- 假设我们有一个加权图，其中每个节点表示一个城市，边的权重表示城市之间的距离。
- 我们可以构建加权度矩阵，其中对角元素表示每个城市的度（即与之相邻的城市的数量）。
- 然后，我们可以计算拉普拉斯矩阵，将加权度矩阵减去邻接矩阵。

让我们来看一个简单的例子：

假设我们有以下加权度矩阵：
$$
D = \begin{bmatrix} 3 & 0 & 0 \\ 0 & 4 & 0 \\ 0 & 0 & 2 \end{bmatrix}
$$
现在，我们有以下邻接矩阵：
$$
A = \begin{bmatrix} 0 & 1 & 0 \\ 1 & 0 & 1 \\ 0 & 1 & 0 \end{bmatrix}
$$
我们可以计算拉普拉斯矩阵：
$$
L = D - A = \begin{bmatrix} 3 & 0 & 0 \\ 0 & 4 & 0 \\ 0 & 0 & 2 \end{bmatrix} - \begin{bmatrix} 0 & 1 & 0 \\ 1 & 0 & 1 \\ 0 & 1 & 0 \end{bmatrix} = \begin{bmatrix} 3 & -1 & 0 \\ -1 & 4 & -1 \\ 0 & -1 & 2 \end{bmatrix}
$$

#### 如何求“最小割”？

**转化目标函数：**
$$
\min \limits_{A_1, ...,A_k} \sum\limits_{l=1}^{k} \sum\limits_{i \in A_l,j \notin A_l} w_{i,j}  \text{转化为} \min\limits_{Q} Tr(Q^{T}LQ), s.t. q_{i,l}\in \{1,-1\}
$$
证明之后补。

$q_{i,l}\in \{1,-1\}$ 整数约束会导致求解不便，对其视为实数，但要求 $q_l^Tq_l = n$

进一步把最小化式子中的常数 $n$ 隐去，就可以最终转化为**计算拉普拉斯矩阵的最小前k个特征值及其对应的特征向量**。

## 微分方程模型

### 导语

对于动态问题，通常可以与变化率、进而与微分方程联系起来。即：可以考虑建立微分方程模型。

微分方程模型建立的步骤：

1. 翻译或转化：将实际问题中的条件转换为表示导数的用词。
2. 建立瞬时表达式
3. 统一物理单位
4. 确定初始条件或边界信息

在建立方程的过程中，既可以使用已知的定律列方程，又可以通过数据提出假设，再根据假设列出方程。

### 水的流出问题

#### 题目原文

一横截面积为 A，高为 H 的水池内盛满了水，有池底一横截面积为 B 的小孔放水。设水从小孔流出的速度为v，求在任意时刻的水面高度和将水放空所需的时间。

#### 问题分析

从水面1到水面2所失去的水量等于从小孔流出的水量。

#### 建模与求解

1. 从水面1到水面2所失去的体积为 $A\Delta h$，在$\Delta t$时间内 ，实际损失的体积是 $A\Delta h$

2. 在同样时间内，水从小孔流出的体积为$B\Delta S$，$\Delta S$是水在$\Delta t$时间内从小孔流出保持水平前进时所经过的距离

#### TODO

### 新产品的销售量

#### 题目原文

一种耐用新产品进入市场后,一般会经过一销售量先不断增加,然后下降的过程(产品的生命周期-PLC).有一种PLC曲线为钟型, 试建立模型分析此现象。

#### 问题分析

当一个新产品进入市场时，有关产品信息的传播途径如何？

信息传播的途径:

1. 厂家提供的广告 ---消费者以外的信息

2. 一部分人购买后对产品的评价使周围人得到的信息---消费者内部的信息

耐用产品的累积销售量可认为是购买者人数

#### 建模与求解

K --- 潜在的消费者总数

n(t) --- t 时刻购买了该产品的人数

则在 $ [ t, t + \Delta t]$ 中, 购买者增量
$$
\Delta n = 
\begin{cases}
\Delta n_1 &\text{来自消费者外部的产品信息导致的购买者增量}\\
\Delta n_2 &\text{来自消费者内部的产品信息导致的购买者增量}
\end{cases}
$$

$$
\Delta n_1 = a(K-n(t))\Delta t 
$$

$$
\Delta n_2 = bn(t)(K-n(t))\Delta t
$$

### 剧院座位设计

#### 本题知识点：微分不等式比较定理

微分不等式比较定理是常微分方程理论中的一个重要工具，它可以用来估计微分方程解的存在区间，以及比较不同微分方程解的大小。这里有两个主要的比较定理：

1. **第一比较定理**：假设 $ f(x, y) $和 $ F(x, y) $ 是在区域 $ D $上定义的两个函数，并且对于 $ D $ 中的每一点 $ (x, y) $，都有 $ f(x, y) \leq F(x, y) $。如果 $ \phi(x) $ 和 $ \Phi(x) $ 分别是初值问题 $ y’ = f(x, y) $，$ y(x_0) = y_0 $ 和 $ y’ = F(x, y) $，$ y(x_0) = y_0 $ 的解，并且在 $ x_0 $ 的某个右邻域内 $ \phi(x) \leq \Phi(x) $，那么在这个邻域内 $ \phi(x) $ 将始终小于或等于 $ \Phi(x) $。
2. **第二比较定理**：在第一比较定理的基础上，如果 $ f(x, y) $ 和 $ F(x, y) $ 满足局部利普希茨条件，并且 $ f(x, y) $ 在 $ y $ 上单调，那么可以得到关于解的最大值和最小值的比较结果。

微分不等式比较定理其实就像是数学版的“跟随领导”的规则。想象一下，你和你的朋友在一条路上走，你们都同意跟随一个看不见的领导。如果你的朋友走得比领导快，那么你也会加速，以确保不会落后于你的朋友。如果你的朋友慢下来，你也会减速。这样，无论你的朋友怎么走，你都会保持在他的后面。

在数学中，我们可以用这个比喻来描述两个函数的关系。假设有两个函数 ( y = f(x) ) 和 ( y = g(x) )，它们都从同一个点 ( x_0 ) 出发。如果我们知道在任何时候 ( f(x) ) 的增长速度都不会超过 ( g(x) ) 的增长速度，那么我们可以说，从 ( x_0 ) 点开始，( f(x) ) 总是小于或等于 ( g(x) )。

**例子**： 想象你有两个水桶，一个桶（我们称它为桶A）有一个小孔，水以恒定的速度慢慢流出。另一个桶（桶B）的孔稍大一些，水流出的速度更快。如果两个桶开始时都装满水，随着时间的推移，我们可以肯定桶A里的水永远不会比桶B少。这是因为桶B的水流出得更快，所以它减少的速度总是比桶A快。

这个例子就是微分不等式比较定理的直观表示。在这里，水的减少速度就像函数的增长速度，桶A和桶B就像是两个不同的函数。我们通过比较它们的“流速”（或者在数学中的“增长速度”），就可以知道它们之间的大小关系。这个定理在数学中非常有用，因为它可以帮助我们理解和比较不同函数的行为。

#### 题目原文

在影视厅或报告厅，经常会为前边观众遮挡住自己的视线而苦恼。显然，场内的观众都在朝台上看，如果场内地面不做成前低后高的坡度模式，那么前边观众必然会遮挡后面观众的视线。试建立数学模型设计良好的报告厅地面坡度曲线。  

#### 问题的假设

1) 观众厅地面的纵剖面图一致，只需求中轴线上地面的起伏曲线即可。

2) 同一排的座位在同一等高线上。

3) 每个坐在座位上的观众的眼睛与地面的距离相等。

4) 每个坐在座位上的观众的头与地面的距离也相等。

5) 所求曲线只要使观众的视线从紧邻的前一个座位的人的头顶擦过即可。

#### 建立坐标系

<img src="数学建模.assets\image-20240320205732793.png" alt="image-20240320205732793" style="zoom:67%;" />

#### 问题

求任一排x与设计视点o的竖直距离函数 $y = y(x) $ 使此曲线满足视线的无遮挡要求。  

#### 建模

设眼睛升起曲线应满足微分方程  $\frac{dy}{dx} = F(x,y) $ ，初始条件 $y|_{x=a} = b$ 

1）从第一排起，观众眼睛与o点的连线的斜率随排数的增加而增加，而眼睛升起曲线显然与这些直线皆相交，故此升起曲线是凹的。

2）选择某排 M ( x, y) 和相邻排

由函数的凹凸性有下面的结论：
$$
M_1(x-d, y_1) \\
M_2(x+d, y_2) \\
k_{MM_1} < k_{y(x)} < k_{MM_2} \\
M_1N_1 = MN = AB = \delta \\
k_{MM_1} = \frac{MA+AB}{M_1B} = \frac{MA+\delta}{d} \\
$$
<img src="数学建模.assets\image-20240320211830285.png" alt="image-20240320211830285" style="zoom:50%;" />

这么多三角形，可以考虑使用相似：

<img src="数学建模.assets\image-20240320211846736.png" alt="image-20240320211846736" style="zoom:50%;" />

在大三角形中也使用相似：

<img src="数学建模.assets\image-20240320211904282.png" alt="image-20240320211904282" style="zoom:55%;" />

#### 模型求解

<img src="数学建模.assets\image-20240320213810934.png" alt="image-20240320213810934" style="zoom:50%;" />

<img src="数学建模.assets\image-20240320213833688.png" alt="image-20240320213833688" style="zoom:50%;" />

<img src="数学建模.assets\image-20240320213848266.png" alt="image-20240320213848266" style="zoom:50%;" />

#### 总结与讨论

利用微分不等式建模。

有时只需求近似解。

#### 模型讨论

1）怎样减少地面的坡度？调整参数、相邻排错位。

2）衡量经济的指标？座位尽量多、升起曲线占据的空间尽量少等。

### 最速降线问题

#### 题目原文

确定一个连接定点A、 B的曲线,使质点在这曲线上用最短的时间由A滑至B点 (忽略摩擦力和阻力)  

#### 问题细化

设有一质点从点A $(x_1, y_1)$ 运动到点B $(x_2, y_2)$  ,该质点的运动速度在上半平面为常数 V1，下半平面为常数V2 .此质点应沿什么路径运动才能使花费时间最短?

#### 建模与求解：方法1——光的性质

<img src="数学建模.assets\image-20240320214415409.png" alt="image-20240320214415409" style="zoom:67%;" />

<img src="数学建模.assets\image-20240320214434982.png" alt="image-20240320214434982" style="zoom:67%;" />

#### 建模与求解：方法二——泛函的极值问题

<img src="数学建模.assets\image-20240320214537796.png" alt="image-20240320214537796" style="zoom:60%;" />

### 交通管理中的黄灯问题

#### 题目原文

交通灯在绿灯转换成红灯时，有一个过渡状态：亮一段时间的黄灯。请分析黄灯应当亮多久。 

#### 题目背景

设想黄灯的作用是什么？不难看出，黄灯起的是警告的作用，意思是马上要转红灯了，假如能停住，请立即停车。停车是需要时间的，在这段时间内，车辆仍将向前行驶一段距离。在离街口距离为M（停车距离）处存在着一条停车线，见图。对于那些黄灯亮时已过线的车辆，则保证它们仍能穿过马路。

<img src="数学建模.assets\image-20240320214817502.png" alt="image-20240320214817502" style="zoom:50%;" />

#### 题目分析

黄灯的持续时间 T 应包括：

1. 驾驶员的决定时间（反应时间）
2. 通过十字路口的时间
3. 停车距离的驾驶时间

#### 建模与求解

T1 驾驶员的决定时间(反应时间) 

T2 通过十字路口的时间

T3 停车距离的驾驶时间

T = T1 + T2 + T3

$T_1$ 可以测量得到

$T_2$ 可以由下面的式子计算得到
$$
T_2 = \frac{I+L}{v_0}
$$
$T_3$ 的计算：

1. 先确定停车距离的大小
   $$
   m \frac{d^{2}x}{dt^2} = -fmg \\
   x(0)=0, \frac{dx}{dt} |_{t=0} = v_0
   $$
   积分一次得刹车时间，积分两次得停车距离
   $$
   x(t_1) = \frac{1}{2} \frac{v_0^2}{fg}
   $$

2. 停车距离除以行驶速度就是$T_3$
   $$
   T_3 = \frac{x(t_1)}{v_0} = \frac{1}{2} \frac{v_0}{fg}
   $$

在最终结果中，总时间 $T$ 随 $v_0$ 的变化是一个先下降后上升的函数，可以找到一个时间最小值，作为最优解。

### 药物在体内的分布

#### 题目亮点

- 药物进入机体形成血药浓度(单位体积血液的药物量)
- 血药浓度需保持在一定范围内——给药方案设计
- 药物在体内吸收、分布和排除过程 ——药物动力学
- 建立房室模型——药物动力学的基本步骤

#### 房室系统

在用微分方程研究实际问题时，人们常常采用一种叫“房室系统”的观点来考察问题。根据研究对象的特征或研究的不同精度要求，我们把研究对象看成一个整体（单房室系统）或将其剖分成若干个相互存在着某种联系的部分（多房室系统）。

房室——机体的一部分，药物在一个房室内均匀分布(血药浓度为常数)，在房室间按一定规律转移。

房室具有以下特征：它由考察对象均匀分布而成，房室中考察对象的数量或浓度（密度）的变化率与外部环境有关，这种关系被称为“交换”且交换满足着总量守衡。以下我们将用房室系统的方法来研究药物在体内的分布。

<img src="数学建模.assets\image-20240325103332327.png" alt="image-20240325103332327" style="zoom:50%;" />

#### 药物分布的单房室模型

+ 药物进入机体形成**血药浓度**（单位体积血液的药物量）
+ 血药浓度需要保持在一定范围内——**给药方案设计**
+ 药物在体内吸收、分布和排除过程——药物动力学
+ 建立**房室模型**——药物动力学的基本模型

![image-20240329145017013](C:\Users\zxm\AppData\Roaming\Typora\typora-user-images\image-20240329145017013.png)

![image-20240329145030193](C:\Users\zxm\AppData\Roaming\Typora\typora-user-images\image-20240329145030193.png)

#### 情况1：快速静脉注射

![image-20240330125753598](C:\Users\zxm\AppData\Roaming\Typora\typora-user-images\image-20240330125753598.png)

#### 恒速静脉点滴

![image-20240330130121033](C:\Users\zxm\AppData\Roaming\Typora\typora-user-images\image-20240330130121033.png)

#### 口服药或肌注



### 为什么要用三级火箭来发射卫星

#### 卫星能在轨道上运动的最低速度

假设：

1. 卫星轨道为过地球中心的某一平面上的圆，卫星在此轨道上做匀速圆周运动
2. 地球是固定于空间中的均匀球体，其他星球对卫星的引力忽略不计

分析：

地球对卫星的引力：
$$
F = \frac{km}{r^2}
$$
 在地面有：
$$
\frac{km}{R^2} = mg
$$
可得：
$$
k = g R^2
$$
代入第一式，得：
$$
F = mg(\frac{R}{r})^2
$$
万有引力 = 向心力，故
$$
F=\frac{mv^2}{r}
$$
解得
$$
v=R\sqrt{\frac{g}{r}}
$$
***上面的操作实际上就是用了高中物理学的黄金代换。***

取  g = 9.81 m/s^2 , R = 6400 km , r = 7000 km ，解得 v = 7.6 km/s

#### 火箭推进力及速度分析

假设不计空气阻力和重力。（高中物理“动量守恒的爆炸模型”）

记火箭在时刻 t 的质量和速度分别为 m(t) 和 v(t)，有：（Lagrange 中值定理）
$$
m(t+\Delta t) - m(t) = \frac{dm}{dt} \Delta t + O(\Delta t^2)
$$
记火箭喷出的气体相对与火箭的速度为 u，由动量守恒定理：
$$
m(t)v(t) = m(t+\Delta t)v(t+\Delta t) - (\frac{dm}{dt} \Delta t)(v(t)-u)+O(\Delta t^2)
$$
得
$$
m \frac{dv}{dt} = -\frac{dm}{dt} u
$$
***其实就是动量守恒定律的微分形式***

（分离变量，两边积分）解得
$$
v(t) = v_0 + u \ln(\frac{m_0}{m(t)})
$$
将火箭-卫星系统的质量分成三部分：

1. $m_p$ 有效负载
2. $m_f$ 燃料质量
3. $m_s$ 结构质量（外壳、燃料容器及推进器等）

最终质量为 $m_p + m_s$ ，初始速度为 0，所以末速度为
$$
v = u \ln(\frac{m_0}{m_p+m_s})
$$
一般地，
$$
m_s = \lambda (m_f + m_s) = \lambda(m_0 + m_p)
$$
则末速度为
$$
v = u \ln(\frac{m_0}{\lambda m_0 + (1- \lambda)m_p})
$$
在一级火箭的情况下，即使有效负载取为 0 ，末速度也不能达到 7.6 km/s
$$
v = u \ln(\frac{1}{\lambda})
$$
u = 3 km/s

$\lambda$ = 0.1

v = 7 km/s

#### 理想火箭模型

TODO

## 种群模型

### 竞争关系

#### 模型假设

有甲乙两个种群，它们独自生存时数量变化均服从Logistic规律：
$$
\dot x_1(t)=r_1x_1(1-\frac{x_1}{N_1}) \\
\dot x_2(t)=r_2x_2(1-\frac{x_2}{N_2})
$$
两种群在一起时，乙对甲增长的阻滞作用与乙的数量成正比; 甲对乙有同样的作用。

#### 竞争模型

$$
\dot x_1(t)=r_1x_1(1-\frac{x_1}{N_1}-\sigma \frac{x_2}{N_2}) \\
\dot x_2(t)=r_2x_2(1-\frac{x_2}{N_2}-\sigma \frac{x_1}{N_1})
$$

其中 $\sigma 1, \sigma 2$ 是非常关键的指标，反映一个种群对另一种群的竞争能力。 

对于消耗甲的资源而言，乙(相对于N2)是甲(相对于N1) 的$\sigma 1$倍。

若 $\sigma 1>1$ 对甲增长的阻滞作用，乙大于甲乙的竞争力。

**模型分析**

我们来探究 $ t \rightarrow \infty$ 时， $x_1(t), x_2(t)$ 的趋向（平衡点及其稳定性）

即探究
$$
\dot x_1(t) = f(x_1, x_2) \\
\dot x_2(t) = g(x_1, x_2)
$$
的平衡点及其稳定性。

**平衡点与稳定平衡点**

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240327210831430.png" alt="image-20240327210831430" style="zoom:50%;" />

### 稳定性模型与竞争关系模型的求解

对象是动态过程，建模目的是研究时间充分长以后过程的变化趋势 ——平衡状态是否稳定。

不求解微分方程，而是用微分方程稳定性理论研究平衡状态的稳定性。

#### 一阶微分方程的平衡点及其稳定性

对于一阶非线性自治方程
$$
\dot x = F(x) \\
$$
有
$$
F(x)=0
$$
的根 $x_0$ 就是微分方程的平衡点。

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240327204328423.png" alt="image-20240327204328423" style="zoom:50%;" />



通常判断平衡点稳定性有两种方法，直接求解法和定性分析法。

下面介绍**定性分析法**。

1. 若方程为线性方程，即 $f(x)=ax+b$ ，有 a<0 时稳定， a>0时不稳定。

2. 若方程为非线性方程，则可以考虑使用泰勒展开来对其进行“线性化”。

   即 $\dot x=F^{\prime}(x_0)(x-x_0)$ ，同样是通过系数来进行判断，结果与线性方程结果相同。

   需要注意的是，这里使用了泰勒展开来对函数在邻域内进行近似，因此我们只能得到在邻域内成立的结论，而不能得到全局中的结论。

#### 二阶微分方程的平衡点及其稳定性

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240327204430851.png" alt="image-20240327204430851" style="zoom:50%;" />

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240327204442730.png" alt="image-20240327204442730" style="zoom:50%;" />

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240327204905648.png" alt="image-20240327204905648" style="zoom:50%;" />

但是p或q=0时，稳定性不确定，需要用其他的方法来判断。

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240327205109894.png" alt="image-20240327205109894" style="zoom:50%;" />

分母不为零，且种群数量为正值，因此对于$P_3$，有上面的约束。

**【考试重点】**

1. 将微分方程的系数矩阵（雅可比矩阵）$A$ 写出来（表达出具体的计算结果）

2. 求矩阵的特征方程
   $$
   \lambda ^2 + p \lambda +q=0
   $$
   其中
   $$
   p=-(f_{x_1}^{\prime}+g_{x_2}^{\prime})|_{P_0} \\
   q = |A|
   $$
   本质就是在四个平衡点处计算 $p$ 和 $q$ 值。

3. 判断是否是稳定的平衡点：

   稳定条件：$p,q>0$ 

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240327211838319.png" alt="image-20240327211838319" style="zoom:50%;" />

#### 平衡点稳定性的相轨线分析

> **相轨线**（Phase Portrait或Phase Trajectory）是常微分方程理论中的一个概念，它用于描述由一组微分方程定义的动力系统的行为。在二维空间中，如果我们有一个包含两个变量x和y的一阶微分方程组，并且给定了特定的初始条件，那么这个方程组的解将以(x(t), y(t))的形式给出。在相平面（即x-y平面）上，随着时间t的变化，这些解会形成一条曲线，这条曲线就被称为相轨线。
>
> 相轨线反映了系统状态随时间变化的动态特性，每一点代表了某个特定时刻系统的位置。通过对相轨线的分析，我们可以了解系统是否稳定、是否存在周期行为（比如闭合轨道表示周期解）、或者是发散、趋近于某固定点或其他复杂动力学行为。
>
> 例如，在物理学中，相轨线可以用来描述振荡器、耦合振子或者电子在电磁场中的运动轨迹；在工程领域，如控制理论中，相轨线可以帮助分析控制系统的行为；在生物数学模型中，它可以用来刻画种群数量随时间的变化趋势等。在更复杂的多维空间中，相轨线的概念可以推广到相空间中的流形结构。
>
> **相平面**是在分析一阶和二阶系统，尤其是非线性系统动态行为时使用的数学工具。在控制系统理论和动力系统理论中，相平面是指用来表示系统状态变量及其变化率之间关系的二维平面。通常选择两个状态变量作为坐标轴，例如：
>
> - 对于一阶系统，可以选择状态变量 $x$ 和其时间导数 $\dot{x} $（即 $x $ 对时间 $t $ 的导数）作为坐标轴。
> - 对于二阶系统，则可以选择状态变量 $x_1$ 和 $x_2 $ 或 $x $ 和 $\dot{x} $ 以及 $\ddot{x} $（$x $ 的二阶导数）作为坐标系的两个轴。
>
> 在相平面上，系统的每个状态都对应着平面上的一个点。当系统随时间演变时，该点会在平面上沿着一条路径移动，这条路径称为相轨迹。相轨迹显示了系统状态随时间变化的全局行为，包括稳定点（不动点）、极限环（周期轨道）和奇异点等特征。
>
> 通过相平面分析，可以直观地研究系统的稳定性、瞬态响应、渐近行为以及其他动力学特性，这对于设计控制系统、优化系统性能和理解复杂系统的整体动态行为至关重要。庞加莱（Poincaré）在1885年首次提出了相平面方法，并且这种方法在后来的系统理论发展中得到了广泛应用。

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240327212950030.png" alt="image-20240327212950030" style="zoom:50%;" />

**对图像的解释：**

在橙色区域的左下方， $\varphi$ 和 $\psi$ 都大于零，因此两种群都有增长趋势，随着时间的增加，坐标向右上方移动。

同理，在黑色区域的右上方， $\varphi$ 和 $\psi$ 都小于零，因此两种群都有减少趋势，随着时间的增加，坐标向左下方移动。

在两条线中间的带状区域， $\varphi$ 大于零，而 $\psi$ 小于零，因此种群一增长，种群二减少，随着时间的增加，坐标向右下拉动，不断靠近 $(N_1,0)$ 点，最终稳定在这个稳定点。

这样就完成了结论从邻域范围向全域推广的过程。

首先我们将 $t$ 剥离，研究种群数量对时间的导数，使用图像来研究。这个图像被称为“**相平面**”。

另外几幅图像如下：

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240327213127482.png" alt="image-20240327213127482" style="zoom:50%;" />

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240327214026190.png" alt="image-20240327214026190" style="zoom:50%;" />

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240327214044454.png" alt="image-20240327214044454" style="zoom:50%;" />

### 相互依存关系

相互依存：甲乙一起生存时相互提供食物、促进增长。  

甲乙两种群的相互依存有三种形式：

1. 甲可以独自生存，乙不能独自生存；
2. 甲乙均可以独自生存；
3. 甲乙均不能独自生存。

#### 模型假设

1. 甲可以独自生存，数量变化服从Logistic规律;甲乙一起生存时乙为甲提供食物、促进增长。

2. 乙不能独自生存；甲乙一起生存时甲为乙提供食物、促进增长；乙的增长又受到本身的阻滞作用。 (服从Logistic规律)

#### 模型

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240327214832176.png" alt="image-20240327214832176" style="zoom:33%;" />

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240327214927530.png" alt="image-20240327214927530" style="zoom:50%;" />

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240327214941379.png" alt="image-20240327214941379" style="zoom:50%;" />

#### 结果解释

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240327215018559.png" alt="image-20240327215018559" style="zoom:50%;" />

### 捕食者与被捕食者模型（弱肉强食模型）

#### 模型建立（Volterra）

设被捕食者（甲）数量为$x(t)$ ，捕食者（乙）数量为$y(t)$

甲独立生存的增长率 $r$ 
$$
\dot{x} = rx 
$$
乙使甲的增长率减小，减小量与 y 成正比
$$
\dot{x}(t) = (r-ay)x = rx - axy \quad(1)
$$
乙独立生存的死亡率 d

$$
\dot{y} = -dy
$$
甲使乙的死亡率减小，减小量与 x 成正比
$$
\dot{y}(t) = -(d-bx)y = -dy+bxy \quad (2)
$$
$a$ ~捕食者掠取食饵能力 $b$ ~食饵供养捕食者能力

#### 模型求解

能解出方程吗？不能，方程(1),(2) 无解析解。

那试试平衡点和稳定性分析？

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240327215309515.png" alt="image-20240327215309515" style="zoom:50%;" />

也不行。

所以只能采取最原始的方法了——暴力画图观察。

利用 matlab 进行计算和画图，发现疑似存在周期性。

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240401103857648.png" alt="image-20240401103857648" style="zoom:50%;" />

因此猜测 $x(t), y(t)$ 为周期函数，相图 $(x,y)$ 是封闭曲线。

从表和图中可以看出下面的信息：

 $x(t), y(t)$ 的周期约为9.6

$x_{max}=65.5, \quad x_{min}= 6,\quad y_{max}= 20.5,\quad y_{min}= 3.9$ 

用数值积分可算出  $x(t), y(t)$ 一周期的平均值： $x(t)$ 的平均值约为25, $y(t)$ 的平均值约为10。

下面使用相轨线分析稳定性

要求解相轨线的方程，首先需要把时间变量消去：
$$
\frac{\dot{x}(t)}{\dot y(t)} = \frac{dx}{dy} = \frac{x(r-ay)}{y(-d+bx)} \\
\frac{-d+bx}{x} dx = \frac{r-ay}{y} dy \\
-d \ln x + bx = r \ln y -ay +c_1 \\
$$
取指数：
$$
(x^de^{-bx})() = c
$$
其中 $c$ 由初始条件来确定。

记第一个因子为 $f(x)$ ，第二个因子为 $g(x)$ ，则有相轨线方程
$$
f(x)g(y)=c
$$
分别研究 $f(x) = x^de^{-bx}$ 和 $g(x)=y^re^{-ay}$ ，有

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240401105116309.png" alt="image-20240401105116309" style="zoom:50%;" />
$$
f(0) = f(\infty) = 0, \quad f(x_0) = f_m,x_0 = \frac{d}{b} \\
g(0) = g(\infty) = 0, \quad g(y_0) = g_m,y_0 = \frac{r}{a}
$$
而且应当注意到，当 $c>f_mg_m$ 时，无相轨线。以下设 $c \leq f_mg_m$



<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240401105557885.png" alt="image-20240401105557885" style="zoom:50%;" />

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240401105630889.png" alt="image-20240401105630889" style="zoom:50%;" />

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240401105652454.png" alt="image-20240401105652454" style="zoom:50%;" />

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240401105808247.png" alt="image-20240401105808247" style="zoom:50%;" />

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240401112058241.png" alt="image-20240401112058241" style="zoom:50%;" />

#### Volterra模型的缺点与改进

多数食饵—捕食者系统观察不到周期震荡,而是趋向某个平衡状态,即存在稳定平衡点。

可以通过增加 Logistic 项来进行改进。

相轨线是封闭曲线，结构不稳定——一旦离开某一条闭轨线，就进入另一条闭轨线，不恢复原状 。但是自然界存在的周期性平衡生态系统是结构稳定的，即偏离周期轨道后，内部制约使系统恢复原状。

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240401112526795.png" alt="image-20240401112526795" style="zoom:50%;" />

相轨线趋向极限环，结构变得更加稳定。

<img src="F:\repo-of-Flo\school curriculums\mathematical modeling\数学建模.assets\image-20240401112603909.png" alt="image-20240401112603909" style="zoom:50%;" />

## 随机模型TODO

随机现象：在一定条件下， 在个别试验或观察中呈现不确定性， 但在大量重复试验或观察中其结果又具有一定规律性的现象。

研究内容： 事件发生的概率大小或统计量

随机建模的目的：

- 研究随机问题所蕴含的统计规律性
- 研究事件发生可能性的大小

### 商家购货策略

#### 题目回顾

某商家代售货物A.每天清晨从供货商购进货物零售,晚上将没有卖掉的货物退回.每份货物的购进价为b元,零售价为a元, 退回价为c元,a>b>c.

该商家每天如果购进的货物太少,不够卖时会少赚钱,如果购得太多卖不完时要赔钱.试为该商家筹划每天购进的货物数， 使得收益最大。

同类问题： 工厂存储原料

#### 问题重述

货物的需求量是随机的,所以这是一个风险决策问题  

商家售货： **a** **(**零售价**) >** **b****(**购进价**) >** **c****(**退回价**)**售出一份赚 **a-b**； 退回一份赔 **b-c**每天购进多少份可使收入最大？

#### 问题分析

购进太多卖不完退回赔钱购进太少不够销售赚钱少应根据需求确定购进量

每天需求量是随机的优化问题的目标函数应是长期的每日平均收入每天收入是随机的存在一个合适的购进量从概率论大数定律知,其等于每天收入的期望

#### 数据准备

调查需求量的随机规律**——**每天需求量为 **r** 的概率 **p****(****r****)****, r****=0,1,2…**

#### 建立模型

• 设每天购进 **n** 份， 日平均收入为 **G****(****n****)**  

已知售出一份赚 **a-b**； 退回一份赔 **b-c**  
$$
G(n) = \sum \limits_{r=0}^{n} [(a-b)r-(b-c)(n-r)]p(r)+\sum\limits_{r = n+1}^{\infty} (a-b)np(r)
$$

## 机器学习之回归分析

回归分析：

- 用于预测的建模技术， 研究的是因变量**/**目标和自变量**/**预测器之间的关系；
- 产生一个将数据映射到一个实值预测变量的函数；
- 主要研究问题包括数据序列的趋势特征以及数据**/**变量间的相关关系等

基本回归方法：

- 回归分析（一元） 基本原理： 使用曲线拟合已知数据点， 在这种方式下， 从曲线到数据点的差异最小
- 推求一个解析函数**y=f(x),** 使其通过或近似通过有限序列的数据点对， 即在一定意义下“最佳” 地逼近已知数据
- 探索用一类与数据的背景材料规律相适应的解析表达式， 用连续的解析函数近似地刻画离散点序列所对应的函数关系

### 一元线性回归

使平方误差达到最小

因变量连续， 自变量可以连续也可以离散， 回归线的性质为线性

线性回归使用最佳回归线在因变量**Y**和自变量**X**之间建立对应关系：  
$$
Y = b_0 + b_1 X + u
$$
使用极值的必要条件——偏导为零得到线性方程组。

### 多元线性回归模型

- 现实生活中引起被解释变量变化的因素并非仅只一个解释变量， 可能有很多个解释变量
- 例如， 对人均国民生产总值的影响因素有：人口变动因素、 固定资产数、 货币供给量、物价指数、 国内国际市场供求关系等
- 在一元线性模型的基础上， 提出多元线性模型**——**解释变量个数≥2

当一个方阵严格主对角线占优，则该方阵可逆。

